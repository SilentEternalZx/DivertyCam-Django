{% extends "layout/layout.html" %}
{% load static %}

{% block content %}
<!DOCTYPE html>
<html>
<head>
    <title>Cámara</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">

</head>
<body>
    <div class="container">
        <h1>Control de Cámara</h1>
        
        <div class="camera-controls">
            <label for="camera-select">Seleccionar cámara:</label>
            <select id="camera-select" onchange="switchCamera(this.value)">
                {% for camera in cameras %}
                <option value="{{ camera.index }}" {% if camera.index == current_camera %}selected{% endif %}>
                    {{ camera.name }}
                </option>
                {% endfor %}
            </select>
        </div>
        
        <div class="camera-settings">
            <div class="setting-control">
                <label for="iso-range">ISO ({{ camera_settings.iso }}):</label>
                <input type="range" id="iso-range" 
                       min="{{ camera_settings.iso_min }}" 
                       max="{{ camera_settings.iso_max }}" 
                       value="{{ camera_settings.iso }}"
                       oninput="updateIsoValue(this.value)">
                <span id="iso-value">{{ camera_settings.iso }}</span>
                <button id="set-iso-btn" onclick="setIso()">Aplicar ISO</button>
            </div>
        </div>
        <div class="setting-control">
            <label for="white-balance-select">Balance de Blancos:</label>
            <select id="white-balance-select" onchange="updateWhiteBalance(this.value)">
                <option value="auto">Automático</option>
                <option value="daylight">Luz de día</option>
                <option value="cloudy">Nublado</option>
                <option value="shade">Sombra</option>
                <option value="tungsten">Tungsteno</option>
                <option value="fluorescent">Fluorescente</option>
                <option value="incandescent">Incandescente</option>
            </select>
        </div>
        
        <div class="camera-container">
            <div id="camera-view">
                <img id="camera-feed" src="{% url 'video_feed' %}" alt="Cámara no disponible">
            </div>
            
            <div class="buttons">
                <button id="capture-btn" onclick="captureImage()">Tomar Foto</button>
                <button id="download-btn" onclick="downloadImage()" disabled>Descargar Última Foto</button>
            </div>
        </div>
        
        <div id="captured-images">
            <h2>Imágenes Capturadas</h2>
            <div id="gallery">
                {% for image in images %}
                <div class="thumbnail">
                    <img src="{% static 'images/' %}{{ image }}" alt="Imagen capturada">
                    <p>{{ image }}</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    <script>
        const setIsoUrl = "{% url 'set_iso' %}";
        const captureUrl = "{% url 'capture' %}";
    </script>
    <script src="{% static 'js/video.js' %}"></script>
</body>
</html>
{% endblock %}

